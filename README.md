# XMap: é«˜æ€§èƒ½åˆ†å¸ƒå¼ç½‘ç»œæœåŠ¡æŒ‡çº¹è¯†åˆ«æ¡†æ¶

XMap æ˜¯ä¸€ä¸ªåŸºäº Go è¯­è¨€çš„é«˜æ€§èƒ½åˆ†å¸ƒå¼ç½‘ç»œæœåŠ¡æŒ‡çº¹è¯†åˆ«æ¡†æ¶ï¼Œå®ƒåœ¨ gonmap çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ¶æ„ä¼˜åŒ–å’ŒåŠŸèƒ½æ‰©å±•ï¼Œä¸“æ³¨äºæä¾›æ›´é«˜æ•ˆã€å¯æ‰©å±•çš„ç½‘ç»œæœåŠ¡è¯†åˆ«èƒ½åŠ›ã€‚XMap ç‰¹åˆ«é€‚åˆåœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œæ”¯æŒå¤šä»»åŠ¡å…±äº«æŒ‡çº¹åº“åŒæ—¶ä½¿ç”¨ç‹¬ç«‹æ‰«æå‚æ•°çš„åœºæ™¯ã€‚

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

- **é«˜æ€§èƒ½æ‰«æå¼•æ“**ï¼šåŸºäº gonmap ä¼˜åŒ–çš„ TCP/UDP æœåŠ¡æ¢æµ‹å’Œè¯†åˆ«
- **å…±äº«æŒ‡çº¹åº“**ï¼šå¤šä»»åŠ¡å…±äº«æŒ‡çº¹åŠ è½½ï¼Œå‡å°‘å†…å­˜å ç”¨å’Œåˆå§‹åŒ–æ—¶é—´
- **ç‹¬ç«‹æ‰«æå‚æ•°**ï¼šæ¯ä¸ªæ‰«æä»»åŠ¡å¯ä½¿ç”¨è‡ªå®šä¹‰çš„æ‰«æå‚æ•°
- **åˆ†å¸ƒå¼æ¶æ„**ï¼šæ”¯æŒæ°´å¹³æ‰©å±•çš„å·¥ä½œèŠ‚ç‚¹
- **çµæ´»çš„æ’ä»¶ç³»ç»Ÿ**ï¼šæ”¯æŒè‡ªå®šä¹‰æ¢æµ‹å’ŒåŒ¹é…é€»è¾‘
- **å®Œå–„çš„ä¸Šä¸‹æ–‡æ§åˆ¶**ï¼šæ”¯æŒè¶…æ—¶å’Œå–æ¶ˆæœºåˆ¶
- **ä¸°å¯Œçš„è¾“å‡ºæ ¼å¼**ï¼šæ”¯æŒ JSONã€CSV ç­‰å¤šç§è¾“å‡ºæ ¼å¼
- **å®æ—¶ç›‘æ§**ï¼šæä¾›æ‰«æè¿›åº¦å’Œèµ„æºä½¿ç”¨æƒ…å†µçš„å®æ—¶ç›‘æ§
- **WebæŒ‡çº¹è¯†åˆ«**ï¼šé›†æˆappfingerå®ç°é«˜æ•ˆçš„Webåº”ç”¨æŒ‡çº¹è¯†åˆ«

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

#### ä½¿ç”¨ go install å®‰è£…

```bash
# ç›´æ¥å®‰è£…æœ€æ–°ç‰ˆæœ¬
go install github.com/tongchengbin/xmap@latest
```

#### ä»æºç å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/tongchengbin/xmap.git
cd xmap

# å®‰è£…ä¾èµ–
go mod download

# ç¼–è¯‘
go build -o xmap main.go

# è¿è¡Œ
./xmap -h
```

#### ä½¿ç”¨Docker

```bash
# æ„å»ºDockeré•œåƒ
docker build -t xmap .

# è¿è¡Œ
docker run --rm xmap -h
```

### åŸºæœ¬ç”¨æ³•

```bash
# æ‰«æå•ä¸ªç›®æ ‡
xmap -target 192.168.1.1

# æ‰«æå¤šä¸ªç«¯å£
xmap -target 192.168.1.1 -ports 80,443,8080-8090

# ä»æ–‡ä»¶è¯»å–ç›®æ ‡
xmap -target-file targets.txt

# ä½¿ç”¨å¿«é€Ÿæ¨¡å¼
xmap -target 192.168.1.1 -fast

# è¾“å‡ºJSONæ ¼å¼ç»“æœ
xmap -target 192.168.1.1 -output results.json -json
```

### ç¼–ç¨‹æ¥å£ç¤ºä¾‹

```go
package main

import (
	"context"
	"fmt"
	"time"

	"github.com/tongchengbin/xmap/pkg/api"
	"github.com/tongchengbin/xmap/pkg/types"
)

func main() {
	// åˆ›å»ºXMapå®ä¾‹
	xmap := api.NewXMap(
		api.WithTimeout(5*time.Second),
		api.WithRetries(2),
		api.WithVersionIntensity(7),
	)

	// åˆ›å»ºæ‰«æç›®æ ‡
	target := &model.ScanTarget{
		IP:       "192.168.1.1",
		Port:     80,
		Protocol: "tcp",
	}

	// æ‰§è¡Œæ‰«æ
	ctx := context.Background()
	result, err := xmap.Scan(ctx, target)
	if err != nil {
		fmt.Printf("æ‰«æå¤±è´¥: %v\n", err)
		return
	}

	// å¤„ç†ç»“æœ
	fmt.Printf("IP: %s, ç«¯å£: %d, æœåŠ¡: %s, ç‰ˆæœ¬: %s\n",
		result.IP, result.Port, result.Service, result.Version)
}
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

XMap é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      XMap Framework                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚             â”‚               â”‚                 â”‚
â”‚  Fingerprintâ”‚   Scanner   â”‚    Matcher    â”‚     Worker      â”‚
â”‚   Manager   â”‚   Engine    â”‚     Engine    â”‚      Pool       â”‚
â”‚             â”‚             â”‚               â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚             â”‚               â”‚                 â”‚
â”‚  Probe      â”‚  Protocol   â”‚   Result      â”‚     Plugin      â”‚
â”‚  Repository â”‚  Handlers   â”‚   Processors  â”‚     System      â”‚
â”‚             â”‚             â”‚               â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŒ‡çº¹ç®¡ç†è®¾è®¡

XMap ä½¿ç”¨å•ä¾‹æ¨¡å¼å®ç° FingerprintManagerï¼Œç¡®ä¿å¤šä»»åŠ¡å…±äº«æŒ‡çº¹åº“ï¼š

```go
// è·å–æŒ‡çº¹ç®¡ç†å™¨å•ä¾‹
func GetFingerprintManager(options *FingerprintOptions) *FingerprintManager {
    // å•ä¾‹å®ç°ç¡®ä¿æŒ‡çº¹åº“åªåŠ è½½ä¸€æ¬¡
    // ...
    return fingerprintManagerInstance
}
```

### æ‰«æå¼•æ“è®¾è®¡

XMap æä¾›ç»Ÿä¸€çš„æ‰«ææ¥å£ï¼Œæ”¯æŒå•ä¸ªå’Œæ‰¹é‡ç›®æ ‡æ‰«æï¼š

```go
// Scanner å®šä¹‰æ‰«æå™¨æ¥å£
type Scanner interface {
    // æ‰§è¡Œå•ä¸ªç›®æ ‡æ‰«æ
    Scan(ctx context.Context, target string, opts ...ScanOption) (*Result, error)
    
    // æ‰§è¡Œæ‰¹é‡ç›®æ ‡æ‰«æ
    BatchScan(ctx context.Context, targets []string, opts ...ScanOption) ([]*Result, error)
}
```

### å·¥ä½œæ± è®¾è®¡

ä¸ºæ”¯æŒé«˜æ•ˆçš„å¹¶å‘æ‰«æï¼ŒXMap å®ç°äº†å·¥ä½œæ± æœºåˆ¶ï¼Œå¯æ ¹æ®éœ€è¦åŠ¨æ€è°ƒæ•´å¹¶å‘åº¦ã€‚

## ğŸ“‹ é¡¹ç›®ç»“æ„

```
xmap/
â”œâ”€â”€ pkg/                      # å…¬å…±åŒ…
â”‚   â”œâ”€â”€ api/                  # APIæ¥å£
â”‚   â”œâ”€â”€ model/                # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ probe/                # æ¢é’ˆå®šä¹‰
â”‚   â”œâ”€â”€ scanner/              # æ‰«æå¼•æ“
â”‚   â””â”€â”€ web/                  # Webæ‰«æ
â”œâ”€â”€ examples/                 # ä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ batch/                # æ‰¹é‡æ‰«æç¤ºä¾‹
â”‚   â””â”€â”€ simple/               # ç®€å•æ‰«æç¤ºä¾‹
â”œâ”€â”€ test/                     # æµ‹è¯•ä»£ç 
â”œâ”€â”€ main.go                   # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ go.mod                    # Goæ¨¡å—å®šä¹‰
â””â”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
```

## âš™ï¸ é…ç½®é€‰é¡¹

XMap æä¾›äº†ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æˆ–ç¼–ç¨‹æ¥å£è®¾ç½®ï¼š

### æ‰«æé€‰é¡¹

- **Timeout**: è¿æ¥è¶…æ—¶æ—¶é—´
- **ScanTimeout**: æ‰«ææ€»è¶…æ—¶æ—¶é—´
- **VersionIntensity**: ç‰ˆæœ¬æ£€æµ‹å¼ºåº¦(0-9)
- **Concurrency**: å¹¶å‘æ‰«ææ•°é‡
- **Retries**: é‡è¯•æ¬¡æ•°
- **RetryInterval**: é‡è¯•é—´éš”
- **Proxy**: ä»£ç†è®¾ç½®
- **EnableTLS**: æ˜¯å¦å¯ç”¨TLS

### æŒ‡çº¹é€‰é¡¹

- **ProbeFilePath**: æŒ‡çº¹æ–‡ä»¶è·¯å¾„
- **EnableCache**: æ˜¯å¦å¯ç”¨ç¼“å­˜
- **CacheTTL**: ç¼“å­˜è¿‡æœŸæ—¶é—´
- **ReloadInterval**: è‡ªåŠ¨é‡è½½é—´éš”

## ğŸ”„ ä¸ gonmap çš„åŒºåˆ«

XMap åœ¨ gonmap çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä»¥ä¸‹å…³é”®æ”¹è¿›ï¼š

1. **æŒ‡çº¹ç®¡ç†ä¼˜åŒ–**ï¼š
   - å®ç°å•ä¾‹æ¨¡å¼çš„æŒ‡çº¹ç®¡ç†å™¨ï¼Œå¤šä»»åŠ¡å…±äº«æŒ‡çº¹åº“
   - æ”¯æŒæŒ‡çº¹ç¼“å­˜å’Œè‡ªåŠ¨é‡è½½æœºåˆ¶

2. **æ¶æ„ä¼˜åŒ–**ï¼š
   - æ¨¡å—åŒ–è®¾è®¡ï¼Œè§£è€¦æ‰«æå’ŒåŒ¹é…é€»è¾‘
   - ç»Ÿä¸€çš„æ‰«ææ¥å£ï¼Œç®€åŒ–è°ƒç”¨æ–¹å¼

3. **åŠŸèƒ½å¢å¼º**ï¼š
   - å·¥ä½œæ± å®ç°ï¼Œæ”¯æŒé«˜æ•ˆå¹¶å‘æ‰«æ
   - æ’ä»¶ç³»ç»Ÿï¼Œæ”¯æŒè‡ªå®šä¹‰æ‰«æå’ŒåŒ¹é…é€»è¾‘
   - æ›´å®Œå–„çš„ä¸Šä¸‹æ–‡æ§åˆ¶å’Œé”™è¯¯å¤„ç†

4. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - å‡å°‘é‡å¤æŒ‡çº¹åŠ è½½ï¼Œé™ä½å†…å­˜å ç”¨
   - ä¼˜åŒ–åŒ¹é…ç®—æ³•ï¼Œæé«˜è¯†åˆ«é€Ÿåº¦
   - æ”¯æŒæ‰«æä»»åŠ¡çš„ä¼˜å…ˆçº§è°ƒåº¦

5. **Webæ‰«æå¢å¼º**ï¼š
   - é›†æˆappfingerï¼Œæä¾›é«˜æ•ˆçš„Webåº”ç”¨æŒ‡çº¹è¯†åˆ«
   - å…±äº«æŒ‡çº¹åº“è®¾è®¡ï¼Œå‡å°‘å†…å­˜å ç”¨

## ğŸ“š æ–‡æ¡£

è¯¦ç»†æ–‡æ¡£è¯·å‚é˜… [Wiki](https://github.com/tongchengbin/xmap/wiki)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å¹¶æ„Ÿè°¢ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£å¦‚ä½•å‚ä¸é¡¹ç›®å¼€å‘ã€‚

## ğŸ“„ è®¸å¯è¯

XMap ä½¿ç”¨ [MIT è®¸å¯è¯](LICENSE)ã€‚

## ğŸ™ è‡´è°¢

XMap åŸºäºä»¥ä¸‹å¼€æºé¡¹ç›®å’Œèµ„æºï¼š

- [rule](https://github.com/tongchengbin/finger-rules) - æä¾›æœåŠ¡æŒ‡çº¹è¯†åˆ«è§„åˆ™
- [appfinger](https://github.com/tongchengbin/appfinger) - æä¾›Webåº”ç”¨æŒ‡çº¹è¯†åˆ«èƒ½åŠ›
- [goflags](https://github.com/projectdiscovery/goflags) - æä¾›å‘½ä»¤è¡Œå‚æ•°è§£æ
- [gologger](https://github.com/projectdiscovery/gologger) - æä¾›æ—¥å¿—è®°å½•åŠŸèƒ½
